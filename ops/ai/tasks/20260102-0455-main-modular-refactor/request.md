# Task: 20260102-0251-main-modular-refactor

## Goal

将 `LyreAutoPlayer/main.py` 精简为核心功能入口，其他功能拆分为扩展模块或插件（含语言/i18n），确保重构后所有功能完整且无行为回归。

### 当前问题

- `main.py` 文件过大（~3000行），包含所有功能逻辑
- 功能模块耦合紧密，难以单独测试或扩展
- 新增功能需要直接修改主文件

### 期望结果

- `main.py` 只保留核心入口与插件加载逻辑
- 功能按职责拆分为独立模块/插件
- 插件可按需加载，加载失败可降级

## Constraints

- 功能不丢失：播放、量化、输入、错误模拟、8-bar、UI 配置、快捷键、浮窗、i18n 等均需保留
- 重构后仍可直接运行 `LyreAutoPlayer/main.py`，不增加用户启动复杂度
- 插件加载失败需可降级并提示，不应导致主程序崩溃
- 配置兼容性保持，旧配置无需迁移即可运行

## Acceptance Criteria

- [ ] `main.py` 只保留核心入口与插件加载逻辑，体积显著缩小
- [ ] i18n 独立为模块/插件，语言切换与 `tr()` 功能正常
- [ ] UI 各 tab/面板已拆分为模块或插件，功能与布局不变
- [ ] 播放、输入、错误模拟、8-bar 等功能按模块拆分后可正常工作
- [ ] 配置兼容性保持，旧配置无需迁移即可运行
- [ ] 插件加载失败可降级并提示，主程序稳定运行
- [ ] 手动验证覆盖主要功能入口与关键操作

## Affected Files (Estimated)

| 文件 | 修改内容 |
|------|----------|
| `LyreAutoPlayer/main.py` | 精简为核心入口 |
| `LyreAutoPlayer/core/` | 新建：核心模块（配置、事件、插件加载） |
| `LyreAutoPlayer/plugins/` | 新建：插件目录 |
| `LyreAutoPlayer/i18n/` | 新建：国际化模块 |
| `LyreAutoPlayer/ui/` | 新建：UI 模块 |

## Risks/Dependencies

- 拆分过程中跨模块引用较多，需避免循环依赖
- 插件接口设计不当可能导致后续扩展困难或破坏现有调用路径
- 重构范围较大，需分阶段执行并持续验证

## Related Tasks

- 前置任务: `20260101-2137-octave-policy-feature` (DONE)

---
*Created: 2026-01-02 02:51*
