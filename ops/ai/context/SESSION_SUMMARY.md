- 背景/目标:
  - 处理 MIDI 长音缺失问题（CC64 延音 + 未关闭音符补尾），用于《凡人修仙传》OP-不凡.mid 等文件。
- 已完成:
  - 在 `_parse_midi()` 中加入 CC64 延音逻辑与轨道末尾 note_off 补齐规则。
  - 补齐规则使用“下一同音前 100ms”与“最多 4 小节”上限。
- 关键修改:
  - `LyreAutoPlayer/ui/editor/piano_roll.py`:
    - 新增 time_signature 收集与默认 4/4。
    - 增加 `second_to_tick()`、`ticks_per_bar_at()`、`append_note()` 辅助逻辑。
    - CC64: sustain_on 时延迟 note_off，sustain_off 统一结束。
    - 轨道末尾补 note_off：下一同音前 100ms，且不超过 4 小节。
- 相关文件:
  - `LyreAutoPlayer/ui/editor/piano_roll.py`（唯一实际改动文件）。
- 验证:
  - `python3 -m py_compile /mnt/d/dw11/piano/LyreAutoPlayer/ui/editor/piano_roll.py` -> Syntax OK。
  - 未运行 GUI 实测（需打开目标 MIDI 验证长音）。
- 风险/待办:
  - 需要在实际 MIDI（如《凡人修仙传》OP-不凡.mid）确认延音效果与补尾上限是否合适。
  - 若仍缺长音，需检查 CC64 控制器范围/轨道层级与 tempo/time_signature 解析一致性。
- 下一步:
  - 用目标 MIDI 回归验证长音是否恢复。
  - 如不够长，调节“100ms + 4 小节”规则或增加配置项。
